{
	"id": "ELSA-2022-9668",
	"advisories": [
		{
			"content": {
				"id": "ELSA-2022-9668",
				"title": "ELSA-2022-9668:  libvirt libvirt-python security update (IMPORTANT)",
				"description": "libvirt\n[5.7.0-34.el7]\n- qemu: blockcopy: Allow late opening of the backing chain of a shallow copy (Peter Krempa)  [Orabug: 33091019]\n- qemu: capabilities: Introduce QEMU_CAPS_BLOCKDEV_SNAPSHOT_ALLOW_WRITE_ONLY (Peter Krempa)  [Orabug: 33091019]\n- qemuDomainBlockCopyCommon: Record updated flags to block job (Peter Krempa)  [Orabug: 33091019]\n- qemuDomainBlockPivot: Move check prior to executing the pivot steps (Peter Krempa)  [Orabug: 33091019]\n- qemuDomainBlockPivot: Copy bitmaps backing checkpoints for virDomainBlockCopy (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: Introduce function to calculate bitmap handling for block-copy (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: Add validator for bitmap chains accross backing chains (Peter Krempa)  [Orabug: 33091019]\n- qemu: blockjob: Store 'flags' for all the block job types (Peter Krempa)  [Orabug: 33091019]\n- qemu: blockjob: Store 'jobflags' with block job data (Peter Krempa)  [Orabug: 33091019]\n- util: json: Introduce virJSONValueArrayConcat (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: Extract calls of qemuBlockGetNamedNodeData into a helper function (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Track and relabel images for bitmap merging (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Introduce support for deleting checkpoints accross snapshots (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Extract calculation of bitmap merging for checkpoint deletion (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Introduce helper to find checkpoint disk definition in parents (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: tolerate missing disks on checkpoint deletion (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Use disk definition directly when creating checkpoint (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: rename disk->chkdisk in qemuCheckpointAddActions (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: rename disk->chkdisk in qemuCheckpointDiscardBitmaps (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: split out checkpoint deletion bitmaps (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Store whether deleted checkpoint is current in a variable (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Extract and export rollback of checkpoint metadata storing (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: Introduce qemuBlockNamedNodeDataGetBitmapByName (Peter Krempa)  [Orabug: 33091019]\n- qemu: snapshot: Propagate active bitmaps through external snapshots (Peter Krempa)  [Orabug: 33091019]\n- qemu: monitor: Add 'granularity' parameter for block-dirty-bitmap-add (Peter Krempa)  [Orabug: 33091019]\n- qemu: snapshot: Fold formatting of snapshot transaction into prepare func (Peter Krempa)  [Orabug: 33091019]\n- qemu: Check for explicit failure of qemuBlockSnapshotAddBlockdev (Peter Krempa)  [Orabug: 33091019]\n- qemu: monitor: Extract internals of qemuMonitorJSONBlockGetNamedNodeData (Peter Krempa)  [Orabug: 33091019]\n- qemu: monitor: Extract data about dirty-bimaps in qemuMonitorBlockGetNamedNodeData (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: enable the snapshot image deletion feature (Pavel Mores)  [Orabug: 33091019]\n- qemu: block: propagate the delete flag to where it can actually be used (Pavel Mores)  [Orabug: 33091019]\n- qemu: checkpoint: fix NULL dereference at create time (Cole Robinson)  [Orabug: 33091019]\n- qemu: snapshot: Mark file becoming backingStore as read-only (Peter Krempa)  [Orabug: 33091019]\n- util: consolidate on one free callback for hash data (Daniel P. Berrange)  [Orabug: 33091019]\n- conf: stop using hash key when free'ing hash entries (Daniel P. Berrange)  [Orabug: 33091019]\n- qemu: checkpoint: Use qemuMonitorTransactionBitmapMergeSourceAddBitmap (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Fix rollback and access to unlocked 'vm' when deleting checkpoints (Peter Krempa)  [Orabug: 33091019]\n- qemu: snapshot: split out preparation of a snapshot with blockdev (Peter Krempa)  [Orabug: 33091019]\n- qemu: monitor: Add helper for generating data for block bitmap merging (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Extract finalizing steps of checkpoint creation (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Split out checkpoint creation code (Peter Krempa)  [Orabug: 33091019]\n- qemu: block: Don't query monitor in qemuBlockStorageSourceCreateDetectSize (Peter Krempa)  [Orabug: 33091019]\n- qemu: monitor: Introduce new interface to query-named-block-nodes (Peter Krempa)  [Orabug: 33091019]\n- util: hash: Introduce virHashHasEntry (Peter Krempa)  [Orabug: 33091019]\n- util: hash: Add new constructor 'virHashNew' (Peter Krempa)  [Orabug: 33091019]\n- util: hash: Add possibility to use simpler data free function in virHash (Peter Krempa)  [Orabug: 33091019]\n- conf: Introduce virDomainDiskByTarget (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Don't update current checkpoint until we are done (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Replace open-coded transaction action generators (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Refactor cleanup in qemuCheckpointCreateXML (Peter Krempa)  [Orabug: 33091019]\n- qemu: domain: Move checkpoint related code to qemu_checkpoint.c (Peter Krempa)  [Orabug: 33091019]\n- qemu: driver: Move checkpoint-related code to qemu_checkpoint.c (Peter Krempa)  [Orabug: 33091019]\n- qemu: Move, rename and export qemuDomObjFromDomain (Peter Krempa)  [Orabug: 33091019]\n- qemu: checkpoint: Don't forbid checkpoint when VM is marked for autodestroy (Peter Krempa)  [Orabug: 33091019]\n- Prepare to hotplug vNUMA targets for non-X86_64 guests (Wim ten Have)  [Orabug: 34256070]\n- qemu: Add missing lock in qemuProcessHandleMonitorEOF (Peng Liang)  [Orabug: 34210159]  {CVE-2021-3975}\n- libvirt: Fix Auto host partitioning threads under single-socket hosts (Wim ten Have)  [Orabug: 34153152]\n\nlibvirt-python\n[5.7.0-34.el7]\n- libvirt-python.spec: Bump 'Obsoletes' version number for libvirt-python (Karl\n  Heubaum)  [Orabug: 34185868]",
				"severity": [
					{
						"type": "vendor",
						"source": "linux.oracle.com/security",
						"vendor": "IMPORTANT"
					}
				],
				"references": [
					{
						"source": "linux.oracle.com/security",
						"url": "https://linux.oracle.com/cve/CVE-2021-3975.html"
					},
					{
						"source": "linux.oracle.com/security",
						"url": "https://linux.oracle.com/errata/ELSA-2022-9668.html"
					}
				],
				"published": "2022-08-01T00:00:00Z"
			},
			"ecosystems": [
				"oracle:7"
			]
		}
	],
	"vulnerabilities": [
		{
			"content": {
				"id": "CVE-2021-3975",
				"references": [
					{
						"source": "linux.oracle.com/security",
						"url": "https://linux.oracle.com/cve/CVE-2021-3975.html"
					}
				]
			},
			"ecosystems": [
				"oracle:7"
			]
		}
	],
	"detection": [
		{
			"ecosystem": "oracle:7",
			"criteria": {
				"operator": "OR",
				"criterions": [
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-admin",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-bash-completion",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-client",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-config-network",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-config-nwfilter",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-interface",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-lxc",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-network",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-nodedev",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-nwfilter",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-qemu",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-secret",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-core",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-disk",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-gluster",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-iscsi",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-logical",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-mpath",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-rbd",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-driver-storage-scsi",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-kvm",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-lxc",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-daemon-qemu",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-devel",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-docs",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-libs",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-lock-sanlock",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-login-shell",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "libvirt-nss",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					},
					{
						"vulnerable": true,
						"package": {
							"name": "python2-libvirt",
							"architectures": [
								"aarch64",
								"x86_64"
							]
						},
						"affected": {
							"type": "rpm",
							"range": [
								{
									"lt": "0:5.7.0-34.el7"
								}
							],
							"fixed": [
								"0:5.7.0-34.el7"
							]
						}
					}
				]
			}
		}
	],
	"data_source": "oracle"
}
